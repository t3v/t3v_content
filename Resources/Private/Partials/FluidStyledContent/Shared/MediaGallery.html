<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers" xmlns:ce="http://typo3.org/ns/TYPO3/CMS/FluidStyledContent/ViewHelpers" data-namespace-typo3-fluid="true">
  <f:if condition="{gallery.rows}">
    <div class="media-gallery--{gallery.position.horizontal} media-gallery--{gallery.position.vertical} media-gallery--{gallery.count.columns}-columns {f:if(condition: data.imageborder, then: 'media-gallery--border')} media-gallery" data-media-gallery-columns="{gallery.count.columns}" data-media-gallery-images="{gallery.count.files}">
      <f:if condition="{gallery.position.horizontal} == 'center'">
        <div class="media-gallery__outer">
          <div class="media-gallery__inner">
      </f:if>

      <f:for each="{gallery.rows}" as="row">
        <div class="media-gallery__row">
          <f:for each="{row.columns}" as="column">
            <f:if condition="{column.media}">
              <div class="media-gallery__column">
                <f:if condition="{column.media.description}">
                  <f:then>
                    <figure class="figure">
                  </f:then>

                  <f:else>
                    <div class="media-gallery__media">
                  </f:else>
                </f:if>

                <f:switch expression="{column.media.type}">
                  <f:case value="3">
                    <f:render section="AudioType" arguments="{_all}" />
                  </f:case>

                  <f:case value="4">
                    <f:render section="VideoType" arguments="{_all}" />
                  </f:case>

                  <f:case default="TRUE">
                    <f:render section="ImageType" arguments="{_all}" />
                  </f:case>
                 </f:switch>

                <f:if condition="{column.media.description}">
                  <f:then>
                      <figcaption class="figcaption">
                        {column.media.description}
                      </figcaption>
                    </figure>
                  </f:then>

                  <f:else>
                    </div>
                  </f:else>
                </f:if>
              </div>
            </f:if>
          </f:for>
        </div>
      </f:for>

      <f:if condition="{gallery.position.horizontal} == 'center'">
          </div>
        </div>
      </f:if>
    </div>
  </f:if>

  <f:section name="ImageType">
    <f:if condition="{column.media.link}">
      <f:then>
        <f:link.typolink parameter="{column.media.link}">
          <f:render section="Media" arguments="{_all}" />
        </f:link.typolink>
      </f:then>

      <f:else>
        <f:if condition="{data.image_zoom}">
          <f:then>
            <ce:link.clickEnlarge image="{column.media}" configuration="{settings.media.popup}">
              <f:render section="Media" arguments="{_all}" />
            </ce:link.clickEnlarge>
          </f:then>

          <f:else>
            <f:render section="Media" arguments="{_all}" />
          </f:else>
        </f:if>
      </f:else>
    </f:if>
  </f:section>

  <f:section name="AudioType">
    <f:render section="Media" arguments="{_all}" />
  </f:section>

  <f:section name="VideoType">
    <f:render section="Media" arguments="{_all}" />
  </f:section>

  <f:section name="Media">
    <f:media
      file="{column.media}"
      height="{column.dimensions.height}"
      width="{column.dimensions.width}"
      title="{column.media.title}"
      alt="{column.media.alternative}"
    />
  </f:section>
</html>